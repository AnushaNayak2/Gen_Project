SELECT A.NAME FROM(
SELECT   NAME, SUM(TIME) AS TOTAL_TIME
 FROM CANDIDATES A 
 LEFT JOIN (SELECT CANDIDATE_ID, submission_time, start_time, TIMESTAMPDIFF(minute,cast(START_TIME as datetime),cast(SUBMISSION_TIME as datetime))  AS TIME 
FROM SUBMISSIONS WHERE TIMESTAMPDIFF(minute,cast(START_TIME as datetime),cast(SUBMISSION_TIME as datetime))   <=10  )B ON A.ID=B.CANDIDATE_ID
 GROUP BY 1
)A WHERE A.TOTAL_TIME>=30 ORDER BY A.NAME ASC


SELECT A.NAME , total_time FROM(
SELECT   NAME, SUM(TIME) AS TOTAL_TIME
 FROM CANDIDATES A 
 LEFT JOIN (SELECT CANDIDATE_ID, (cast(SUBMISSION_TIME as datetime)-cast(START_TIME as datetime))/100 AS TIME 
FROM SUBMISSIONS WHERE 
(cast(SUBMISSION_TIME as datetime)-cast(START_TIME as datetime))/100 <=10  

)B ON A.ID=B.CANDIDATE_ID
 GROUP BY 1
)A WHERE name like '%Alex%' ORDER BY A.NAME ASC  ;
